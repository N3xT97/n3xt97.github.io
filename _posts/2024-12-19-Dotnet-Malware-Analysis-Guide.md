---
title: 'π“‘ "DotNet", Malware Analysis Guide'
date: 2024-12-19 21:00:00 +0900
categories: [Malware Analysis Guide]
tags: [malware_analysis_guide, dotnet]
render_with_liquid: falsed
---
**DotNet** μ‚¬μ©λ‰μ΄ μ¦κ°€ν•λ©΄μ„ κ³µκ²©μλ“¤ λν•  DotNetμΌλ΅ μ‘μ„±λ ν¨μ»¤λ‚ μ•…μ„±μ½”λ“λ¥Ό μ‚¬μ©ν•λ” μ‚¬λ΅€κ°€ μ¦κ°€ν•κ³  μμµλ‹λ‹¤. μΌλ°μ μΌλ΅ λ‚΄λ¶€μ μ•”νΈν™”λ μ•…μ„± λ¨λ“μ„ λ³µνΈν™” λ° λ΅λ“ν•μ—¬ μ‹¤ν–‰ν•κΈ° λ•λ¬Έμ— μ–΄λ–¤ λ¨λ“λ“¤μ„ λ΅λ“ν•λ”μ§€ ν™•μΈν•  ν•„μ”κ°€ μμµλ‹λ‹¤. μμ‹¬μ¤λ¬μ΄ λ¨λ“μ΄ ν™•μΈλμ—λ‹¤λ©΄, DotNet λ””λ²„κ±°μΈ dnspyλ¥Ό attachν•μ—¬ μ–΄λ–¤ ν–‰μ„λ¥Ό ν•λ”μ§€ λ¶„μ„ν•©λ‹λ‹¤.

## <mark>1. μ•…μ„± DotNet μƒν” λ¶„μ„</mark>

### β– <u>ProcessHackerλ¥Ό μ‚¬μ©ν•΄ λ¨λ“ ν™•μΈ</u>

μƒν” .NET νμΌμ„ μ‹¤ν–‰ν–λ”λ°, ν•μ„ ν”„λ΅μ„Έμ¤λ΅ aspent_compliler.exeλ¥Ό μ‹¤ν–‰ν•¨μ„ ν™•μΈν–μµλ‹λ‹¤.

<img src="../images/2024-12-19-Dotnet-Packer-Malware-Analysis-Guide/IMG-λ‹·λ„· ν¨μ»¤ λ¶„μ„-20240818160206327-1734612493031-1.png" alt="IMG-λ‹·λ„· ν¨μ»¤ λ¶„μ„-20240818160206327" style="zoom:80%;" />

ν•΄λ‹Ή ν•μ„ ν”„λ΅μ„Έμ¤μ— λ΅λ“λ λ¨λ“λ“¤μ„ ν™•μΈν• κ²°κ³Ό, vikλΌλ” μμ‹¬μ¤λ¬μ΄ λ¨λ“μ„ ν™•μΈν•  μ μμ—μµλ‹λ‹¤.

<img src="../images/2024-12-19-Dotnet-Packer-Malware-Analysis-Guide/IMG-λ‹·λ„· ν¨μ»¤ λ¶„μ„-20240818160206418-1734612498391-3.png" alt="IMG-λ‹·λ„· ν¨μ»¤ λ¶„μ„-20240818160206418" style="zoom:80%;" />

### β– <u>dnspyλ¥Ό μ‚¬μ©ν•΄ λ¨λ“ λ¶„μ„</u>

dnspyμ attach to process κΈ°λ¥μ„ μ‚¬μ©ν•μ—¬ μμ‹¬μ¤λ¬μ΄ ν”„λ΅μ„Έμ¤μ— attach ν•©λ‹λ‹¤.

![IMG-λ‹·λ„· ν¨μ»¤ λ¶„μ„-20240818160208983](../images/2024-12-19-Dotnet-Packer-Malware-Analysis-Guide/IMG-λ‹·λ„· ν¨μ»¤ λ¶„μ„-20240818160208983-1734612503242-5.png)

dnspyλ¥Ό μ‚¬μ©ν•λ©΄ attachν• ν”„λ΅μ„Έμ¤μ modulesμ„ ν™•μΈν•  μ μμµλ‹λ‹¤.

<img src="../images/2024-12-19-Dotnet-Packer-Malware-Analysis-Guide/IMG-λ‹·λ„· ν¨μ»¤ λ¶„μ„-20240818160212530-1734612506801-7.png" alt="IMG-λ‹·λ„· ν¨μ»¤ λ¶„μ„-20240818160212530" style="zoom:80%;" />

<img src="../images/2024-12-19-Dotnet-Packer-Malware-Analysis-Guide/IMG-λ‹·λ„· ν¨μ»¤ λ¶„μ„-20240818160214932-1734612522101-9.png" alt="IMG-λ‹·λ„· ν¨μ»¤ λ¶„μ„-20240818160214932" style="zoom:80%;" />

Go To Moduleλ΅ μμ‹¬μ¤λ¬μ΄ λ¨λ“μ„ ν™•μΈν•©λ‹λ‹¤. μ΄λ• ν™•μΈλλ” μ •λ³΄λ” λ””μ¤ν¬ μƒμ μ •λ³΄λ΅ μμ‹¬μ¤λ¬μ΄ APIλ¥Ό ν™•μΈν•  μ μ—†μµλ‹λ‹¤. λ””μ¤ν¬ μƒμ μ •λ³΄λ¥Ό ν™•μΈν•λ” μ΄μ λ” λ¨λ“μ΄ ν• λ΅μ‰λμ—λ”μ§€ ν™•μΈν•κΈ° μ„ν•¨μ…λ‹λ‹¤. μΌλ°μ μ€ ν”„λ΅μ„Έμ¤λ” ν”„λ΅μ„Έμ¤λ¥Ό ν• λ΅μ‰ν•μ§€ μ•μµλ‹λ‹¤.

![IMG-λ‹·λ„· ν¨μ»¤ λ¶„μ„-20240818160216667](../images/2024-12-19-Dotnet-Packer-Malware-Analysis-Guide/IMG-λ‹·λ„· ν¨μ»¤ λ¶„μ„-20240818160216667-1734612531904-11.png)

![IMG-λ‹·λ„· ν¨μ»¤ λ¶„μ„-20240818160218064](../images/2024-12-19-Dotnet-Packer-Malware-Analysis-Guide/IMG-λ‹·λ„· ν¨μ»¤ λ¶„μ„-20240818160218064-1734612535011-13.png)

Open Module from Memoryλ΅ ν•΄λ‹Ή λ¨λ“μ λ©”λ¨λ¦¬λ¥Ό ν™•μΈν•©λ‹λ‹¤. μ΄λ• ν™•μΈλλ” μ •λ³΄λ” λ©”λ¨λ¦¬ μƒμ μ •λ³΄λ΅ μμ‹¬μ¤λ¬μ΄ APIλ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤. λ§μ•½ λ””μ¤ν¬ μƒκ³Ό λ©”λ¨λ¦¬ μƒμ μ½”λ“κ°€ λ‹¤λ¥΄λ‹¤λ©΄, μ •μƒμ μΈ νμΌμ„ νΈμ¶ν• ν›„ λ©”λ¨λ¦¬ μƒμ—μ„ μ΄λ―Έμ§€λ¥Ό λ®μ–΄ μ“°λ” ν• λ΅μ‰μ΄ λμ—μ„ κ°€λ¥μ„±μ΄ λ†’μµλ‹λ‹¤.

<img src="../images/2024-12-19-Dotnet-Packer-Malware-Analysis-Guide/IMG-λ‹·λ„· ν¨μ»¤ λ¶„μ„-20240818160219386-1734612538631-15.png" alt="IMG-λ‹·λ„· ν¨μ»¤ λ¶„μ„-20240818160219386" style="zoom:80%;" />

<img src="../images/2024-12-19-Dotnet-Packer-Malware-Analysis-Guide/IMG-λ‹·λ„· ν¨μ»¤ λ¶„μ„-20240818160220640-1734612546582-17.png" alt="IMG-λ‹·λ„· ν¨μ»¤ λ¶„μ„-20240818160220640"  />

Go to EntryPointλ¥Ό μ‚¬μ©ν•λ©΄ EP μ½”λ“λ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤.

<img src="../images/2024-12-19-Dotnet-Packer-Malware-Analysis-Guide/IMG-λ‹·λ„· ν¨μ»¤ λ¶„μ„-20240818160221711-1734612552876-19.png" alt="IMG-λ‹·λ„· ν¨μ»¤ λ¶„μ„-20240818160221711" style="zoom:80%;" />

<img src="../images/2024-12-19-Dotnet-Packer-Malware-Analysis-Guide/IMG-λ‹·λ„· ν¨μ»¤ λ¶„μ„-20240818160222876-1734612555292-21.png" alt="IMG-λ‹·λ„· ν¨μ»¤ λ¶„μ„-20240818160222876" style="zoom:80%;" />