---
title: 'π“‘ "CyberChef", Malware Analysis Guide'
date: 2024-12-22 21:00:00 +0900
categories: [Malware Analysis Guide]
tags: [malware_analysis_guide, cyberchef]
render_with_liquid: falsed
---

κ³µκ²©μλ“¤μ€ μ•…μ„± ν–‰μ„λ¥Ό μ¨κΈ°κΈ° μ„ν•΄, μ μ•λ ¤μ§„ μ•”νΈλ¥Ό μ‚¬μ©ν•μ—¬ λ¬Έμμ—΄ λ° μ½”λ“λ¥Ό μ•”νΈν™”ν•κΈ°λ„ ν•©λ‹λ‹¤. μ΄λ•, **CyberChef** λ„κµ¬λ¥Ό μ‚¬μ©ν•λ©΄ μ¶”κ°€μ μΈ μ½”λ”©μ—†μ΄ κ°„λ‹¨ν•κ² μ•”νΈν™”λ¥Ό ν•΄κ²°ν•  μ μμµλ‹λ‹¤.

## <mark>1. CyberChef</mark>

λ‹¤μ–‘ν• μ•”νΈν™”λ¥Ό μ§€μ›ν•λ” λ¶„μ„ν΄λ΅ μ¨λΌμΈ, μ¤ν”„λΌμΈ ν™κ²½μ—μ„ λ¨λ‘ μ΄μ© κ°€λ¥.

> [!NOTE]
> 
> π”— [CyberChef](https://github.com/gchq/CyberChef)



## <mark>2.Β  μƒν” λ¶„μ„ (AES λ³µνΈν™”)</mark>

### β– <u>AES μ •λ³΄ ν™•μΈ</u>

DotNet μƒν” λ‚΄λ¶€μ—μ„ AES μ•”νΈν™”λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄ ν™•μΈλμ—μµλ‹λ‹¤. λν•, μ½”λ“ μƒμ—μ„ AES λ³µνΈν™”μ— ν•„μ”ν• KeySize, BlockSize, CipherMode, PaddingMode μ •λ³΄λ¥Ό ν™•μΈν•  μ μμ—μµλ‹λ‹¤.

<img src="../images/2024-12-22-CyberChef-Malware-Analysis-Guide/IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919171545973-1734831152273-1.png" alt="IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919171545973" style="zoom:80%;" />

CyberChefλ” PaddingModeκ°€ PKCS7μΈ AES Decryptλ¥Ό μ§€μ›ν•λ―€λ΅, CyberChefλ¥Ό μ‚¬μ©ν•΄μ„ λ³µνΈν™” ν•΄λ³΄κ² μµλ‹λ‹¤.

<img src="../images/2024-12-22-CyberChef-Malware-Analysis-Guide/IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919172040842-1734831158396-3.png" alt="IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919172040842" style="zoom:80%;" />

### β– <u>AES Key κµ¬ν•κΈ°</u>

λ¨Όμ € AES Encrypt Keyλ¥Ό ν™•μΈν•κΈ° μ„ν•΄ thIxrsJXpUκ°€ μ–΄λ””μ„ Assignλλ”μ§€ ν™•μΈν•©λ‹λ‹¤.

<img src="../images/2024-12-22-CyberChef-Malware-Analysis-Guide/IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919172254090-1734831497555-9.png" alt="IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919172254090" style="zoom:80%;" />

<img src="../images/2024-12-22-CyberChef-Malware-Analysis-Guide/IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919172140728.png" alt="IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919172140728" style="zoom:80%;" />

AES Keyλ” rLbmKwyrUDcRYdλΌλ” ν•¨μ λ‚΄μ—μ„ Rfc2898DeriveBytes APIμ— μν•΄μ„ μƒμ„±λλ” κ²ƒμ΄ ν™•μΈλμ—μµλ‹λ‹¤.

<img src="../images/2024-12-22-CyberChef-Malware-Analysis-Guide/IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919172422588.png" alt="IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919172422588" style="zoom:80%;" />

μ•”νΈ κΈ°λ° ν‚¤ νμƒ κΈ°λ¥μΈ PBKDF2λ¥Ό κµ¬ν„ν•λ” APIλ΅ CyberChefμ—μ„ μ§€μ›ν•λ” μ•κ³ λ¦¬μ¦μ…λ‹λ‹¤. CyberChefλ¥Ό μ‚¬μ©ν•κΈ° μ„ν•΄μ„λ” Rfc2898DeriveBytesμ— λ€ν• μ¶”κ°€μ μΈ μ •λ³΄κ°€ ν•„μ”ν•©λ‹λ‹¤.

> [!NOTE]
> 
> π”— [Rfc2898DeriveBytes](https://learn.microsoft.com/ko-kr/dotnet/api/system.security.cryptography.rfc2898derivebytes?view=net-8.0)

```c#
public Rfc2898DeriveBytes (byte[] password, byte[] salt, int iterations);
```

<img src="../images/2024-12-22-CyberChef-Malware-Analysis-Guide/IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919172919002.png" alt="IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919172919002" style="zoom:80%;" />

μ½”λ“ μƒμ—μ„ Rfc2898DeriveBytesλ” SHA1 μ•κ³ λ¦¬μ¦μ„ μ‚¬μ©ν•λ©°, μ „λ‹¬λλ” λ°λ³µ νμλ” 50000μ΄λΌλ” κ²ƒμ„ μ• μ μμµλ‹λ‹¤.

<img src="../images/2024-12-22-CyberChef-Malware-Analysis-Guide/IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919173949065.png" alt="IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919173949065" style="zoom:80%;" />

passwordμ™€ salt νλΌλ―Έν„°μ— μ „λ‹¬λλ” κ°’μ„ μ—­μ¶”μ ν•©λ‹λ‹¤.

<img src="../images/2024-12-22-CyberChef-Malware-Analysis-Guide/IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919174332346.png" alt="IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919174332346" style="zoom:80%;" />

<img src="../images/2024-12-22-CyberChef-Malware-Analysis-Guide/IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919174435136.png" alt="IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919174435136" style="zoom:80%;" />

passwordμ—λ” TEcGeTTkKXPrijmN.XqqDBwjaELqXAZqκ°€ μ „λ‹¬λλ” κ²ƒμ΄ ν™•μΈλμ—μΌλ©°, Base64λ΅ μΈμ½”λ”©λμ–΄ μλ” κ²ƒ κ°™μ€ λ¬Έμμ—΄μ…λ‹λ‹¤.

<img src="../images/2024-12-22-CyberChef-Malware-Analysis-Guide/IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919174545149.png" alt="IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919174545149" style="zoom:80%;" />

saltμ—λ” TEcGeTTkKXPrijmN.QBmUzntuXqvIλΌλ” λ°”μ΄νΈ μ—΄μ΄ μ „λ‹¬λ©λ‹λ‹¤.

<img src="../images/2024-12-22-CyberChef-Malware-Analysis-Guide/IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919175228379.png" alt="IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919175228379" style="zoom:80%;" />

<img src="../images/2024-12-22-CyberChef-Malware-Analysis-Guide/IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919175253783.png" alt="IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919175253783" style="zoom:80%;" />

<img src="../images/2024-12-22-CyberChef-Malware-Analysis-Guide/IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919175422668.png" alt="IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919175422668" style="zoom: 67%;" />

ν•΄λ‹Ή μ •λ³΄λ¥Ό ν† λ€λ΅ CyberChefμ—μ„ PBKDF2 μ•κ³ λ¦¬μ¦μ„ μ‹¤ν–‰ν•λ©΄ 256bit(= 32byte) ν‚¤λ¥Ό νλ“ν•  μ μμµλ‹λ‹¤.

<img src="../images/2024-12-22-CyberChef-Malware-Analysis-Guide/IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919175505140.png" alt="IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919175505140" style="zoom:67%;" />

### β– <u>IV κµ¬ν•κΈ°</u>

AES Keyλ¥Ό κµ¬ν• μ΄ν›„μ—λ” IVλ¥Ό κµ¬ν•΄μ•Ό ν•©λ‹λ‹¤. μ½”λ“λ¥Ό ν™•μΈν•΄λ³΄λ©΄ qRHqCFYVDfrq ν•¨μμ— μ „λ‹¬λ κ°’μ μ²« 16 bytesλ¥Ό μ‚¬μ©ν•λ” κ²ƒμ„ μ• μ μμµλ‹λ‹¤.

<img src="../images/2024-12-22-CyberChef-Malware-Analysis-Guide/IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919180210079.png" alt="IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919180210079" style="zoom:80%;" />

qRHqCFYVDfrq ν•¨μμ— μ „λ‹¬λλ” μΈμλ¥Ό μ—­μ¶”μ  ν•΄λ³΄λ©΄ base64 λ””μ½”λ”©λ λ¬Έμμ—΄μ΄ μ „λ‹¬λλ” κ²ƒμ΄ ν™•μΈ κ°€λ¥ν•©λ‹λ‹¤.

<img src="../images/2024-12-22-CyberChef-Malware-Analysis-Guide/IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919180711065.png" alt="IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919180711065" style="zoom:80%;" />

<img src="../images/2024-12-22-CyberChef-Malware-Analysis-Guide/IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919185612732.png" alt="IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919185612732" style="zoom:80%;" />

<img src="../images/2024-12-22-CyberChef-Malware-Analysis-Guide/IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919180742547.png" alt="IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919180742547" style="zoom:80%;" />

<img src="../images/2024-12-22-CyberChef-Malware-Analysis-Guide/IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919180802653.png" alt="IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919180802653" style="zoom:80%;" />

ν™•μΈν• base64 λ¬Έμμ—΄μ„ CyberChef λ””μ½”λ”©ν•μ—¬ μ²« 16 bytesλ¥Ό κµ¬ν•΄ IVλ΅ μ‚¬μ©ν•©λ‹λ‹¤. λ’· λ¶€λ¶„μ€ AESλ΅ μ•”νΈν™”λ λ°μ΄ν„° μ…λ‹λ‹¤.

<img src="../images/2024-12-22-CyberChef-Malware-Analysis-Guide/IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919200851981.png" alt="IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919200851981" style="zoom:67%;" />

### β– <u>AES λ³µνΈν™”</u>

μ•μ„ κµ¬ν• μ •λ³΄μ™€ CyberChefλ¥Ό μ‚¬μ©ν•μ—¬ λ’· λ¶€λ¶„ λ°μ΄ν„°λ¥Ό AES λ³µνΈν™”ν•©λ‹λ‹¤. μ“°λ κΈ° κ°’ λ’¤μ— μ•…μ„± λ„λ©”μΈ ν™•μΈμ΄ κ°€λ¥ν•©λ‹λ‹¤.

<img src="../images/2024-12-22-CyberChef-Malware-Analysis-Guide/IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919201046899.png" alt="IMG-CyberChefλ¥Ό μ‚¬μ©ν• λ³µνΈν™”-20240919201046899" style="zoom:67%;" />