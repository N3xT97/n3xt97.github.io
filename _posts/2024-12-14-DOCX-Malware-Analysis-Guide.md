---
title: 'π“‘ "DOCX", Malware Analysis Guide'
date: 2024-12-14 21:00:00 +0900
categories: [Malware Analysis Guide]
tags: [malware_analysis_guide, pdf]
render_with_liquid: false
---

DOCX νμΌμ€ Microsoft Word λ²„μ „ 2007 μ΄μƒμ κΈ°λ³Έ νμΌ ν•μ‹μ΄λ©° μ΄μ „ DOC νμΌ ν•μ‹μ„ λ€μ²΄ν•©λ‹λ‹¤. XMLκ³Ό ZIP μ••μ¶•μ΄ κ²°ν•©λ Open XML νμΌ ν•μ‹μ„ κΈ°λ°μΌλ΅, μ••μ¶• ν•΄μ λ¥Ό ν†µν•΄ λ‚΄λ¶€ λ‚΄μ©μ„ ν™•μΈν•  μ μλ‹¤λ” νΉμ§•μ΄ μμµλ‹λ‹¤. κ³µκ²©μλ” VBA Macrosλ¥Ό μ§€μ›ν•λ” μ κ³Ό μ™Έλ¶€μ—μ„ Templateμ„ λ‹¤μ΄λ΅λ“ν•  μ μλ‹¤λ” μ μ„ μ•…μ©ν•μ—¬ μ‹μ¤ν…μ— μ•…μ„±μ½”λ“λ¥Ό λ°°ν¬ν•©λ‹λ‹¤.

## <mark>1. DOCX νμΌ</mark>

DOCX νμΌμ€ Microsoft Wordμ—μ„ λ§λ“  λ¬Έμ„λ¥Ό λ§λ“¤κ³  μ €μ¥ν•λ”λ° μ‚¬μ©λλ” νμΌ ν•μ‹μ…λ‹λ‹¤. Microsoft Word λ²„μ „ 2007 μ΄μƒμ κΈ°λ³Έ νμΌ ν•μ‹μ΄λ©° μ΄μ „ DOC νμΌ ν•μ‹μ„ λ€μ²΄ν•©λ‹λ‹¤. XMLκ³Ό ZIP μ••μ¶•μ΄ κ²°ν•©λ Open XML νμΌ ν•μ‹μ„ κΈ°λ°μΌλ΅, μ••μ¶• ν•΄μ λ¥Ό ν†µν•΄ λ‚΄λ¶€ λ‚΄μ©μ„ ν™•μΈν•  μ μμµλ‹λ‹¤. κ³µκ²©μλ” DOC νμΌκ³Ό λ§μ°¬κ°€μ§€λ΅ VBA Macrosλ¥Ό μ•…μ©ν•  μ μμ„ λΏλ§ μ•„λ‹λΌ, μ™Έλ¶€μ—μ„ μ•…μ„± VBA Macrosλ¥Ό ν¬ν•¨ν•λ” Templateλ¥Ό λ‹¤μ΄λ΅λ“ν•λ” κΈ°λ¥μ„ μ‚¬μ©ν•μ—¬ μ•…μ„±μ½”λ“λ¥Ό μ‹μ¤ν…μ— λ°°ν¬ν•  μ μμµλ‹λ‹¤.

![IMG-docx λ¶„μ„-20240921144844901](../images/2024-12-14-DOCX-Malware-Analysis-Guide/IMG-docx λ¶„μ„-20240921144844901.png)

## <mark>2. DOCX νμΌ λ‚΄λ¶€</mark>

### β– <u>\\word\\media\\</u>

'\\word\\media\\' ν΄λ”μ—μ„λ” λ¬Έμ„ λ‚΄λ¶€μ— μ΅΄μ¬ν•λ” μ΄λ―Έμ§€ νμΌμ„ ν™•μΈν•  μ μμµλ‹λ‹¤. μ•…μ„±μ½”λ“λ” μ •μƒμ μΈ νμΌλ΅ μ„μ¥ν•΄ μ‚¬μ©μκ°€ VBA Macrosλ¥Ό ν™μ„±ν™”ν•λ„λ΅ μ λ„ν•κΈ° μ„ν•΄ μ΄λ―Έμ§€λ¥Ό ν™μ©ν•©λ‹λ‹¤.

<img src="../images/2024-12-14-DOCX-Malware-Analysis-Guide/IMG-docx λ¶„μ„-20240921144845063.png" alt="IMG-docx λ¶„μ„-20240921144845063" style="zoom:80%;" />

<img src="../images/2024-12-14-DOCX-Malware-Analysis-Guide/IMG-docx λ¶„μ„-20240921144844982.png" alt="IMG-docx λ¶„μ„-20240921144844982" style="zoom:80%;" />


### β– <u>\\word\\rels\\settings.xml.rels</u>

'\\word\\rels\\settings.xml.rels' νμΌμ—μ„λ” μ™Έλ¶€λ΅λ¶€ν„° λ‹¤μ΄λ΅λ“ν•λ” Template μ£Όμ†λ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤. κ³µκ²©μλ” DOCX λ¬Έμ„μ—λ” VBA Macrosλ¥Ό ν¬ν•¨ν•μ§€ μ•κ³ , μ™Έλ¶€λ΅λ¶€ν„° μ•…μ„± VBA Macrosλ¥Ό ν¬ν•¨ν•λ” Template νμΌμ„ λ‹¤μ΄λ΅λ“ν•λ” **Template Injection** μ„ μ‚¬μ©ν•μ—¬ μ•…μ„±μ½”λ“λ¥Ό μ‹μ¤ν…μ— λ°°ν¬ν•©λ‹λ‹¤.

<img src="../images/2024-12-14-DOCX-Malware-Analysis-Guide/IMG-docx λ¶„μ„-20240921144845148.png" alt="IMG-docx λ¶„μ„-20240921144845148" style="zoom:80%;" />



## <mark>3. oletools</mark>

oletoolsλ” Microsoft Office 97-2003 λ¬Έμ„, Microsoft OLE2 λ¬Έμ„(MS-CBF), MS Office 2007+ λ¬Έμ„(OOXML)λ¥Ό λ¶„μ„ν•κΈ° μ„ν• νμ΄μ¬ λ„κµ¬ ν¨ν‚¤μ§€μ…λ‹λ‹¤. 

> [!NOTE]
>
> π”— [oletools](https://github.com/decalage2/oletools)

<img src="../images/2024-12-14-DOCX-Malware-Analysis-Guide/image-20241215111427020.png" alt="image-20241215111427020" style="zoom:80%;" />

## <mark>4. μ•…μ„± DOCX μƒν” λ¶„μ„</mark>

### β– <u>DOCX νμΌ λ‚΄λ¶€ μ •λ³΄ ν™•μΈ</u>

oletools λ„κµ¬ μ¤‘ ν•λ‚μΈ oleidλ¥Ό μ‚¬μ©ν•λ©΄, DOCX λ‚΄λ¶€ μ •λ³΄λ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤. μƒν”μ κ²½μ°, **External Relationships** μ™Έλ¶€ ν…ν”λ¦Ώμ΄ ν™•μΈλμ—μµλ‹λ‹¤.

```powershell
oleid <filename>
```

<img src="../images/2024-12-14-DOCX-Malware-Analysis-Guide/IMG-docx λ¶„μ„-20240921144845234.png" alt="IMG-docx λ¶„μ„-20240921144845234" style="zoom:80%;" />

### β– <u>External Relationships ν™•μΈ</u>

oletools λ„κµ¬ μ¤‘ ν•λ‚μΈ oleobjλ¥Ό μ‚¬μ©ν•λ©΄, μ™Έλ¶€ ν…ν”λ¦Ώ μ£Όμ†λ¥Ό νλ“ν•  μ μμµλ‹λ‹¤.

```powershell
oleobj <filename>
```

<img src="../images/2024-12-14-DOCX-Malware-Analysis-Guide/IMG-docx λ¶„μ„-20240921144845311.png" alt="IMG-docx λ¶„μ„-20240921144845311" style="zoom:80%;" />

Powershell λ…λ Ήμ–΄λ¥Ό μ‚¬μ©ν•λ©΄, ν•΄λ‹Ή νμΌμ„ λ‹¤μ΄λ΅λ“ λ°›μ„ μ μμµλ‹λ‹¤.

```powershell
Invoke-WebRequest -Uri <src> -OutFile <dst>
```



### β– <u>DOTM νμΌ λ‚΄λ¶€ μ •λ³΄ ν™•μΈ</u>

DOTM νμΌλ„ DOCX νμΌμ²λΌ oleidλ¥Ό μ‚¬μ©ν•μ—¬ λ‚΄λ¶€ μ •λ³΄λ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤. μμ‹¬μ¤λ¬μ΄ VBA Macrosκ°€ ν™•μΈλμ—μµλ‹λ‹¤.

<img src="../images/2024-12-14-DOCX-Malware-Analysis-Guide/IMG-docx λ¶„μ„-20240921144845403.png" alt="IMG-docx λ¶„μ„-20240921144845403" style="zoom:80%;" />

### β– <u>VBA Macros ν™•μΈ</u>

olevbaλ¥Ό μ‚¬μ©ν•μ—¬, VBA Macrosλ¥Ό ν™•μΈν•μ—¬ μ•…μ„±μΈμ§€ λ¶„μ„ν•©λ‹λ‹¤.

<img src="../images/2024-12-14-DOCX-Malware-Analysis-Guide/IMG-docx λ¶„μ„-20240921144845464.png" alt="IMG-docx λ¶„μ„-20240921144845464" style="zoom:80%;" />
